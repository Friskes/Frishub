{% extends 'main_app/base.html' %}

{% load static %}
{% load i18n %}

{% block head %}
<script id="viewer"></script>

<script>
  let gamePatch = JSON.parse(localStorage.getItem('game_patch'));
  if (!gamePatch || gamePatch == 'wrath') { window.GAME_PATCH = 'wrath'; }
  else if (gamePatch == 'live') {
    window.GAME_PATCH = gamePatch;
    $(document).ready(() => $('#change_game_patch')[0].style.backgroundImage = 'url(/static/main_app/images/live.png)');
  };

  const LOCAL_VIEWER = `/static/main_app/javascript/wow-model-viewer/viewer_${window.GAME_PATCH}.js`;
  const LOCAL_VIEWER_MIN = `/static/main_app/javascript/wow-model-viewer/viewer_${window.GAME_PATCH}.min.js`;
  const UNLOCAL_VIEWR_MIN = `https://wow.zamimg.com/modelviewer/${window.GAME_PATCH}/viewer/viewer.min.js`;
  $('#viewer')[0].src = LOCAL_VIEWER_MIN;

  const WH_TOOLTIP_LIVE = ''; // актуал
  const WH_TOOLTIP_WOTLK = 'wotlk/';
  const WH_TOOLTIP_URL = `https://www.wowhead.com/${WH_TOOLTIP_WOTLK}{% if LANGUAGE_CODE == 'ru' %}ru/{% else %}{% endif %}item=`;

  const DEFAULT_ICON_URL = 'https://wow.zamimg.com/images/wow/icons/large/'; // small // medium // large
  // const DEFAULT_ICON_URL = `https://render-classic-us.worldofwarcraft.com/icons/56/`; // 18 // 36 // 56
</script>

<script>
  const RACES = {
    1: 'Human',
    2: 'Orc',
    3: 'Dwarf',
    4: 'Nightelf',
    5: 'Scourge',
    6: 'Tauren',
    7: 'Gnome',
    8: 'Troll',
    10: 'Bloodelf',
    11: 'Draenei'
  };

  const GENDERS = {
    0: 'Male',
    1: 'Female'
  };

  const DEFAULT_SLOT_ICONS = {
    1: 'inventoryslot_head',
    3: 'inventoryslot_shoulder',
    16: 'inventoryslot_chest', // Back
    5: 'inventoryslot_chest',
    4: 'inventoryslot_shirt',
    19: 'inventoryslot_tabard',
    9: 'inventoryslot_wrists',
    10: 'inventoryslot_hands',
    6: 'inventoryslot_waist',
    7: 'inventoryslot_legs',
    8: 'inventoryslot_feet',
    21: 'inventoryslot_mainhand',
    22: 'inventoryslot_offhand',
    23: 'inventoryslot_ranged'
  };

  const ITEM_QUALITIES = {
    0: 'poor-wow',      // (gray)
    1: 'common-wow',    // (white)
    2: 'uncommon-wow',  // (green)
    3: 'rare-wow',      // (blue)
    4: 'epic-wow',      // (purple)
    5: 'legendary-wow', // (orange)
    7: 'heirloom-wow'   // (blizzard blue) фамильные
  };

  // Default model options
  let model_opts = {
    "race": 1,
    "gender": 1,
    "items": [
      // 'Head': 1,
      // 'Shoulder': 3,
      // 'Cloak': 16,
      // 'Chest': 5,
      // 'Shirt': 4,
      // 'Tabard': 19,
      // 'Wrist': 9,
      // 'Hands': 10,
      // 'Waist': 6,
      // 'Legs': 7,
      // 'Feet': 8,
      // 'Оружия ближнего боя': 15, 22, 23 (лев. рука) 13, 17, 21, 25, 26 (прав. рука)
      // 'все дальнобойные кроме луков': 15, 22, 23 (лев. рука) 13, 17, 21, 25, 26 (прав. рука)
      // 'только луки': 15, 22, 23 (лев. рука)
    ],
    sheathMain: -1,
    sheathOff: -1,
  };


  // быть в руке/на персонаже MH и OF могут только вместе.
  // -1 // оружие в руке
  // 1  // оружие на спине смотрит вниз
  // 2  // оружие на спине смотрит вверх
  // 3  // оружие на поясе
  // для всех оружий
  // [-1, -1]
  // [1, 1]
  // для одноручных оружий
  // [1, 3]
  // [3, 1]
  // для двуручных оружий смотрящих вниз
  // [1, 2]
  // для двуручных оружий смотрящих вверх
  // [2, 1]

  function slotIdsIsExists(...slotIds) {
    for (const slotId of slotIds) {
      for (const i in model_opts.items) {
        if (model_opts.items[i][0] == slotId) return i;
      };
    };
    return false;
  };
  function updateSheathInfo() {
    if (slotIdsIsExists(22, 23) === false) { window.dressUI.char.sheath_opts = [[-1, -1], [1, 1], [2, 1]]; }
    else { window.dressUI.char.sheath_opts = [[-1, -1], [1, 1], [1, 3], [3, 1]]; };
  };


  // Actual model and UI parameters
  window.dressUI = {
    active_cat: 'gear',
    gear: {
      items_menu: {
        slot1:  {name: 'Head',     quality: 4, index: 0, type: 'Cloth', available_types: ["Cloth", "Leather", "Mail", "Plate", "Miscellaneous"]},
        slot3:  {name: 'Shoulder', quality: 4, index: 0, type: 'Cloth', available_types: ["Cloth", "Leather", "Mail", "Plate", "Miscellaneous"]},
        slot16: {name: 'Back',     quality: 4, index: 0, type: 'Cloth', available_types: ["Cloth"]},
        slot5:  {name: 'Chest',    quality: 4, index: 0, type: 'Cloth', available_types: ["Cloth", "Leather", "Mail", "Plate", "Miscellaneous"]},
        slot4:  {name: 'Shirt',    quality: 4, index: 0, type: 'Miscellaneous', available_types: ["Miscellaneous"]},
        slot19: {name: 'Tabard',   quality: 4, index: 0, type: 'Miscellaneous', available_types: ["Miscellaneous"]},
        slot9:  {name: 'Wrist',    quality: 4, index: 0, type: 'Cloth', available_types: ["Cloth", "Leather", "Mail", "Plate", "Miscellaneous"]},
        slot10: {name: 'Hands',    quality: 4, index: 0, type: 'Cloth', available_types: ["Cloth", "Leather", "Mail", "Plate", "Miscellaneous"]},
        slot6:  {name: 'Waist',    quality: 4, index: 0, type: 'Cloth', available_types: ["Cloth", "Leather", "Mail", "Plate", "Miscellaneous"]},
        slot7:  {name: 'Legs',     quality: 4, index: 0, type: 'Cloth', available_types: ["Cloth", "Leather", "Mail", "Plate"]},
        slot8:  {name: 'Feet',     quality: 4, index: 0, type: 'Cloth', available_types: ["Cloth", "Leather", "Mail", "Plate", "Miscellaneous"]},
        slot21: {name: 'MainHand', quality: 4, index: 0, type: 'Axe', available_types: ["Axe", "Sword", "Mace", "Dagger", "Fist Weapon", "Staff", "Polearm", "Fishing Pole", "Exotic", "Miscellaneous"]},
        slot22: {name: 'OffHand',  quality: 4, index: 0, type: 'Axe', available_types: ["Axe", "Sword", "Mace", "Dagger", "Fist Weapon", "Shield", "Miscellaneous"]},
        slot23: {name: 'Ranged',   quality: 4, index: 0, type: 'Bow', available_types: ["Bow", "Gun", "Wand", "Crossbow", "Thrown"]}
      }
    },
    char: {
      race_id: model_opts.race,
      gender_id: model_opts.gender,
      anim: 0,
      default_anim: 0,
      sheath: 0,
      sheath_opts: [],
      only_item: false,
      only_item_data: {type: 1, id: 58187, itemId: 45176, slotId: 21} // меч из пенопласта
    },
    face: {
      id: '#dressing-room-face-settings',
      key: 'face',
      fields: [],
      max_len: [],
      min_len: [],
      current: [],
      have_text_opt: []
    },
  };

  updateSheathInfo();

  let PREV_ITEM_ELEMS = {1:{},3:{},16:{},5:{},4:{},19:{},9:{},10:{},6:{},7:{},8:{},21:{},22:{},23:{}};
</script>

<link rel="stylesheet" type="text/css" href="{% static 'main_app/css/dressing-room.css' %}">

<style>
  .dress-btn {
    user-select: none;
    border: 0;
    border-radius: 2px;
    color: #cccccc;
    cursor: pointer;
    display: inline-block;
    font-family: "Open Sans", Arial, "Helvetica Neue", Helvetica, sans-serif;
    font-size: 13px;
    font-weight: 600 !important;
    line-height: 1.4;
    margin-bottom: 0;
    padding: 6px 12px;
    text-align: center;
    vertical-align: middle;
    white-space: nowrap
  }
  .dress-btn:focus {
    box-shadow: 0 0 0 0;
  }
  .btn-site:hover,
  .btn-site:active {
    color: #676af7 !important;
  }
  .btn-site[disabled],
  .btn-site.btn-disabled {
    opacity: 0.3;
  }
</style>

<style>
  input[type="checkbox"] {
    background: transparent;
    border: 0;
    cursor: pointer;
    font-size: inherit;
    margin: 0.1em 0.25em 0;
    padding: 0;
    top: auto !important;
    -moz-appearance: initial
  }
  input[type="checkbox"],
  input[type="checkbox"]:before {
    line-height: inherit !important;
    vertical-align: top
  }
  input[type="checkbox"]::-ms-check {
    width: 1.2em;
  }
  input[type="checkbox"]:after {
    background: rgba(30, 30, 30, 1);
    border-radius: 1px;
    border: 0.125em solid #444;
    box-sizing: border-box;
    content: "";
    display: inline-block;
    height: 1.2em;
    width: 1.2em;
  }
  input[type="checkbox"]::-ms-check {
    background: rgba(30, 30, 30, 1);
    border-radius: 4px;
    border: 0.125em solid #444;
    box-sizing: border-box;
    content: "";
    display: inline-block;
    height: 1.2em;
    width: 1.2em;
    color: #ffd100
  }
  input[type="checkbox"]:checked:before {
    display: inline-block;
    font: normal normal normal 14px FontAwesome;
    font-size: inherit;
    -moz-osx-font-smoothing: grayscale;
    -webkit-font-smoothing: antialiased;
    text-decoration: none;
    text-rendering: auto;
    content: "";
    color: #ffd100;
    margin-right: 0
  }
  input[type="checkbox"]:checked:before {
    font-size: 1.5em;
    margin: -.2em 0 0 -.05em;
    line-height: 1 !important;
    pointer-events: none;
    position: absolute
  }
  input[type="checkbox"] {
    margin: 0.1em 0.25em 0 !important;
    vertical-align: top !important
  }
  input[type="checkbox"] {
    margin: 12px 12px 0 0 !important;
    position: relative;
    top: 2px;
  }
</style>

<style>
  .paperdoll {
    /* бэкграунд под моделью */
    /* background: #202020; */
    border-radius: 6px;
    line-height: 0;

    /* min-height: 362px; */
    max-height: 620px !important;

    min-width: 300px;
    /* overflow: hidden; */
    position: relative
  }
  .paperdoll div {
    line-height: normal
  }
  .paperdoll .paperdoll-left,
  .paperdoll .paperdoll-right,
  .paperdoll .paperdoll-bottom {
    pointer-events: none
  }
  .paperdoll .paperdoll-left>*:not(.paperdoll-hidden),
  .paperdoll .paperdoll-right>*:not(.paperdoll-hidden),
  .paperdoll .paperdoll-bottom>*:not(.paperdoll-hidden) {
    pointer-events: auto
  }
  .paperdoll .paperdoll-left,
  .paperdoll .paperdoll-right {
    bottom: 55px;
    position: absolute;
    top: 3px;
    width: 44px;
    z-index: 11
  }
  .paperdoll .paperdoll-left {
    left: 3px;
  }
  .paperdoll .paperdoll-right {
    right: 3px;
  }
  .paperdoll .paperdoll-bottom {
    bottom: 47px;
    height: 0;
    left: 0;
    position: absolute;
    text-align: center;
    white-space: nowrap;
    width: 100%;
    z-index: 12;
    user-select: none;
  }
  .paperdoll .paperdoll-bottom .paperdoll-enchant {
    transform: scale(0.75);
    transform-origin: right
  }
  .paperdoll .paperdoll-bottom .iconlarge+.paperdoll-enchant,
  .paperdoll .paperdoll-bottom .iconmedium+.paperdoll-enchant {
    transform-origin: left
  }
  .paperdoll .paperdoll-model {
    bottom: 47px;
    left: 47px;
    min-width: 277px;
    position: absolute;
    right: 47px;
    top: 0;
    z-index: 1
  }
  .paperdoll .paperdoll-model-inner {
    bottom: 0;
    height: auto !important;
    left: 0;
    position: absolute !important;
    right: 0;
    top: 0;
    width: auto !important
  }
  .paperdoll .paperdoll-model-inner canvas {
    height: 100%;
    width: 100%;
    max-height: 100%;
    max-width: 100%;
  }
  .paperdoll .paperdoll-responsive-shell {
    line-height: 0;
    margin: 0 47px 47px;
    position: relative;
    width: calc(100% - 94px)
  }
  .paperdoll .paperdoll-responsive-expander {
    /* margin-top: 131.407942238%; */
    margin-top: 999%;
  }
  .paperdoll .paperdoll-hidden.iconlarge,
  .paperdoll .paperdoll-hidden.iconmedium,
  .paperdoll .paperdoll-hidden.iconsmall {
    opacity: .2
  }
  .paperdoll .paperdoll-hidden.iconlarge,
  .paperdoll .paperdoll-hidden.iconlarge *,
  .paperdoll .paperdoll-hidden.iconmedium,
  .paperdoll .paperdoll-hidden.iconmedium *,
  .paperdoll .paperdoll-hidden.iconsmall,
  .paperdoll .paperdoll-hidden.iconsmall * {
    pointer-events: none
  }
  .fullscreen-icon {
    color: #cccccc;
  }
  .fullscreen-icon:hover {
    color: #cccccc;
  }
  .paperdoll .paperdoll-controls-left {
    bottom: 16px;
    font-size: 12px;
    left: 5px;
    line-height: 1.2;
    position: absolute;
    right: calc(50% - -44px);
    text-align: left;
    z-index: 10
  }
  .paperdoll .paperdoll-controls-right {
    bottom: 34px;
    font-size: 20px;
    position: absolute;
    z-index: 10;
    left: calc(50% - 168px);
  }
  /* Если мы на мобильном */
  @media screen and (max-width: 800px) {
    .paperdoll .paperdoll-controls-right {
      bottom: 25px;
      font-size: 17px;
      left: calc(50% - 90px);
    }
  }
  .paperdoll .paperdoll-controls-left div,
  .paperdoll .paperdoll-controls-right div {
    margin: 3px 0 0
  }
  .paperdoll .paperdoll-controls-left div:first-child,
  .paperdoll .paperdoll-controls-right div:first-child {
    margin: 0
  }
  .paperdoll .paperdoll-quality a {
    font-size: 14px
  }
  .paperdoll .paperdoll-quality .active {
    color: #fff;
    cursor: default;
    font-weight: bold
  }
  .paperdoll .paperdoll-mount {
    display: none;
    line-height: 26px;
    margin-left: -2px !important;
    white-space: nowrap
  }
  .paperdoll .paperdoll-mount>a {
    background: url(https://wow.zamimg.com/images/Paperdoll/red-drake.png) left bottom no-repeat;
    border-radius: 0 0 0 6px;
    box-sizing: border-box;
    float: left;
    font-size: 13px;
    font-weight: bold;
    height: 60px;
    margin: 0 0 -5px -3px;
    min-width: 74px;
    padding: 37px 0 0 5px;
    text-shadow: 1px 1px 1px #202020;

    letter-spacing: .05em;
    text-decoration: none;
  }
  .paperdoll .paperdoll-mount>a:hover {
    -webkit-filter: brightness(1.35);
    filter: brightness(1.35);

    color: white;
  }
  .paperdoll .paperdoll-mount:after {
    content: ' ';
    clear: left;
    display: block
  }
  .paperdoll[data-icon-size="large"] .paperdoll-left,
  .paperdoll[data-icon-size="large"] .paperdoll-right {
    width: 68px
  }
  .paperdoll[data-icon-size="large"] .paperdoll-bottom {
    bottom: 71px
  }
  .paperdoll[data-icon-size="large"] .paperdoll-responsive-shell {
    margin: 0 71px 71px
  }
  .paperdoll[data-icon-size="large"] .paperdoll-controls-left {
    right: calc(50% - -68px)
  }
  .paperdoll-picker .listview td.none {
    text-align: center;
    font-weight: bold
  }
  .paperdoll-enchant-disabled {
    opacity: 0.2;
    pointer-events: none
  }

  .caret-disabled {
    opacity: 0.5;
    pointer-events: none !important;
  }
</style>

<style>
  /* button icons https://fontawesome.com/v4/icons/ */
  @font-face {
    font-family: "FontAwesome";
    src: url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/FontAwesome.otf);
    src: url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.eot) format("embedded-opentype"),
         url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.woff2) format("woff2"),
         url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.woff) format("woff"),
         url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.ttf) format("truetype"),
         url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/fonts/fontawesome-webfont.svg) format("svg");
    font-weight: normal;
    font-style: normal;
  }
  .fa:before {
      display: inline-block;
      font: normal normal normal 14px/1 FontAwesome;
      font-size: inherit;
      text-rendering: auto;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale
  }
  .fa-caret-left:before {
    content: "\f0d9"
  }
  .fa-caret-right:before {
    content: "\f0da"
  }
  .fa-times:before {
    content: "\f00d"
  }
  .fa-eye-slash:before {
    content: "\f070"
  }
  .fa-link:before {
    content: "\f0c1"
  }
  .fa-camera:before {
    content: "\f030"
  }
  .fa-pause:before {
    content: "\f04c"
  }
  .fa-play:before {
    content: "\f04b"
  }
  .fa-random:before {
    content: "\f074"
  }
  .fa-undo:before {
    content: "\f0e2"
  }
  .fa-repeat:before {
    content: "\f01e"
  }
  .fa-expand:before {
    content: "\f065"
  }
  .fa-square:before {
    content: "\f0c8"
  }
  .fa-check-square:before {
    content: "\f14a"
  }
</style>

<style>
  .btn-close-items-menu-left {
    cursor: Pointer;
    height: 24px;
    width: auto;
    margin-right: 3%;
  }
  .btn-close-items-menu-right {
    cursor: Pointer;
    height: 24px;
    width: auto;
    margin-left: 3%;
  }
  .table-responsive {
    max-height: 173px;
    display: grid;
  }

  .paperdoll-left, .paperdoll-right, .paperdoll-bottom {
    z-index: auto !important;
  }
  /* .slot-container {
    z-index: auto !important;
  } */
  .iconlarge {
    z-index: 13 !important;
  }

  .items-menu {
    z-index: 14 !important;

    position: absolute;
    display: none;
    min-width: 326px;
    /* max-width: 326px; */
    height: auto;
    border: 2px solid #1fb8ff;
    border-radius: 4px 4px 4px 4px;
    background-color: rgba(0, 0, 0, 1);
    font-size: 12px;
    line-height: 19px;
    text-align: center;
    box-shadow: 0 0 30px 10px #ffffff12;
    padding: 6px 1px 8px 0; /* top, right, bottom, left */
    margin-top: -10px;
  }

  .items-menu-left-up {
    right: 3px;
  }
  .items-menu-left-down {
    right: 3px;
  }
  .items-menu-left-down-crutch {
    bottom: 66px;
  }

  .items-menu-right-up {
    left: 3px;
  }
  .items-menu-right-down {
    left: 3px;
  }

  .items-menu-bottom-left {
    left: 123px;
    top: 2px;
  }
  .items-menu-bottom-center {
    right: 193px;
    top: 2px;
  }
  .items-menu-bottom-right {
    right: 124px;
    top: 2px;
  }

  /* Если мы на мобильном */
  @media screen and (max-width: 800px) {
    .table-responsive {
      max-height: 159px;
    }

    .items-menu {
      min-width: 318px;
      margin-top: 0px;
    }

    .items-menu-left-up {
      left: -17px;
    }
    .items-menu-left-down {
      left: -17px;
    }
    .items-menu-left-down-crutch {
      bottom: 35px;
    }

    .items-menu-right-up {
      left: -266px;
    }
    .items-menu-right-down {
      left: -266px;
    }

    .items-menu-bottom-left {
      left: -7px;
      top: 35px;
    }
    .items-menu-bottom-center {
      left: -7px;
      top: 35px;
    }
    .items-menu-bottom-right {
      left: -7px;
      top: 35px;
    }
  }
</style>

<style>
  .warning-toast-message {
    display: none;
    position: absolute;
    margin: auto;
    top: calc(35%);
    left: 0;
    right: 0;
    max-width: 35%;
    z-index: 13;
    border-radius: 15%;
    background-color: rgba(0, 0, 0, 0.5);
    user-select: none;
    pointer-events: none;
  }
  /* Если мы на мобильном */
  @media screen and (max-width: 379px) {
    .warning-toast-message {
      top: calc(20%);
      max-width: 50%;
    }
  }
  .warning-toast-message-icon {
    font-size: 50px;
  }
  .warning-toast-message-text {
    padding: 0 15px 15px 15px;
    font-size: 22px;
    font-weight: 600;
    white-space: break-spaces;
  }
</style>

<style>
  .first-btn-wow {
    font-size: 21px;
    padding: 0 2px 0 4px;
  }
  .first-btn-wow:hover {
    opacity: 0.5;
  }
  .medium-btn-wow {
    font-size: 21px;
    padding: 0 2px 0 2px;
  }
  .medium-btn-wow:hover {
    opacity: 0.5;
  }
  .last-btn-wow {
    font-size: 21px;
    padding: 0 4px 0 2px;
  }
  .last-btn-wow:hover {
    opacity: 0.5;
  }

  .poor-wow {
    color: #9d9d9d;
  }
  .poor-wow:hover {
    color: #9d9d9d;
  }
  .common-wow {
    color: #ffffff;
  }
  .common-wow:hover {
    color: #ffffff;
  }
  .uncommon-wow {
    color: #1eff00;
  }
  .uncommon-wow:hover {
    color: #1eff00;
  }
  .rare-wow {
    color: #0070dd;
  }
  .rare-wow:hover {
    color: #0070dd;
  }
  .epic-wow {
    color: #a01cf8;
  }
  .epic-wow:hover {
    color: #a01cf8;
  }
  .legendary-wow {
    color: #ff8000;
  }
  .legendary-wow:hover {
    color: #ff8000;
  }
  .heirloom-wow {
    color: #00ccff;
  }
  .heirloom-wow:hover {
    color: #00ccff;
  }
</style>

<style>
  .text-uline {
    text-decoration: underline;
  }

  .dressing-room-character-controls-category-option>div[data-role="control"] {
    user-select: none;
  }
  .dressing-room-character-controls-category-option>div[data-role="control"] .imitation-select {
    pointer-events: none;
  }

  .dressing-room-character-controls-category-switchers a[data-category="patch"]:after {
    background: left;
    background-size: auto 100%;
  }

  .dressing-room-character-controls-category[data-category="face"],
  .dressing-room-character-controls-category[data-category="character"] {
    user-select: none;
  }
</style>
{% endblock %}

{% block body %}
<app-dressing-room _nghost-gox-c37="" style="font-size: 14.5px;">
  <div _ngcontent-gox-c37="" class="page-size bg-check p-2 p-md-5 mb-5" style="overflow: hidden;">
    <div _ngcontent-gox-c37="" class="m-auto text-center" style="padding-top: 60px; padding-bottom: 60px;">
      <div _ngcontent-gox-c37="" class="mb-2">

        <div id="dressing-room" class="dressing-room" data-loaded="true">
          <div class="dressing-room-character" data-class="1" data-race="10" data-npc-race="false"
            data-gender="0" data-gender-restriction="no-restriction" data-category="gear">

            <div class="paperdoll" id="dressing-room-paperdoll" data-icon-size="large" data-separate-shoulders="false">

              <div class="paperdoll-left">
                <div class="slot-container">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="1">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_head.jpg&quot;);"></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-left-up">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(1);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(1, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge paperdoll-hidden" data-env="live" data-tree="live" data-game="wow" data-character-slot="2">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_neck.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-left-up">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(2);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(2, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="3">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_shoulder.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-left-up">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(3);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(3, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="16">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_chest.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-left-up">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(16);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(16, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="5">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_chest.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-left-down">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(5);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(5, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="4">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_shirt.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-left-down">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(4);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(4, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="19">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_tabard.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-left-down">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(19);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(19, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="9">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_wrists.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-left-down items-menu-left-down-crutch">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(9);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(9, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="paperdoll-right">
                <div class="slot-container">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="10">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_hands.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-right-up">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(10);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(10, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="6">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_waist.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-right-up">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(6);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(6, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="7">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_legs.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-right-up">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(7);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(7, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="8">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_feet.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-right-up">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(8);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(8, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge paperdoll-hidden" data-env="live" data-tree="live" data-game="wow" data-character-slot="11">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_finger.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-right-down">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(11);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(11, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge paperdoll-hidden" data-env="live" data-tree="live" data-game="wow" data-character-slot="12">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_finger.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-right-down">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(12);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(12, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge paperdoll-hidden" data-env="live" data-tree="live" data-game="wow" data-character-slot="13">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_trinket.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-right-down">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(13);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(13, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container">
                  <div class="iconlarge paperdoll-hidden" data-env="live" data-tree="live" data-game="wow" data-character-slot="14">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_trinket.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-right-down">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(14);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(14, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="paperdoll-bottom">
                <div class="slot-container" style="display: inline-block;">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="21"
                    style="display: inline-block; position: relative; z-index: 1;">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_mainhand.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-bottom-left">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(21);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(21, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container" style="display: inline-block;">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="22"
                    style="display: inline-block; position: relative; z-index: 1;">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_offhand.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-bottom-center">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(22);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(22, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
                <div class="slot-container" style="display: inline-block;">
                  <div class="iconlarge" data-env="live" data-tree="live" data-game="wow" data-character-slot="23"
                    style="display: inline-block; position: relative; z-index: 1;">
                    <ins style="background-image: url(&quot;https://wow.zamimg.com/images/wow/icons/large/inventoryslot_ranged.jpg&quot;);" class=""></ins>
                    <del></del>
                    <a href="javascript:"></a>
                  </div>
                  <div class="items-menu items-menu-bottom-right">
                    <div class="d-block d-md-block mb-2">
                      <div class="dressing-room-character-controls-category-option" data-character-customization-type="item_type"
                        style="align-items: center; justify-content: center;">
                        <a class="btn dress-btn fa fa-square first-btn-wow poor-wow" href="javascript:" tabindex="-1" data-quality="0"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow common-wow" href="javascript:" tabindex="-1" data-quality="1"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow uncommon-wow" href="javascript:" tabindex="-1" data-quality="2"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow rare-wow" href="javascript:" tabindex="-1" data-quality="3"></a>
                        <a class="btn dress-btn fa fa-check-square medium-btn-wow epic-wow" href="javascript:" tabindex="-1" data-quality="4"></a>
                        <a class="btn dress-btn fa fa-square medium-btn-wow legendary-wow" href="javascript:" tabindex="-1" data-quality="5"></a>
                        <a class="btn dress-btn fa fa-square last-btn-wow heirloom-wow" href="javascript:" tabindex="-1" data-quality="7"></a>
                        <div tabindex="0" data-role="control" data-disabled="false" id="select_item_type_btn" style="padding-right: 2px;">
                          <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                          <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                          <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                        </div>
                      </div>
                    </div>
                    <div class="table-responsive"></div>
                    <div class="d-block d-md-block mt-2">
                      <button class="btn-custom btn-close-items-menu-left" onclick="clearItemSlots(23);">{% trans 'Очистить слот' %}</button>
                      <button class="btn-custom btn-close-items-menu-right"
                        onclick="slot_switcher(23, this.parentElement.parentElement);">{% trans 'Закрыть' %}</button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="paperdoll-model">
                <!-- style="border: 1px solid rgba(255, 255, 255, 0.5);"> -->
                <div class="paperdoll-model-inner" id="paperdoll-model-dressing-room-paperdoll"></div>
              </div>

              <div class="paperdoll-responsive-shell">
                <div class="paperdoll-responsive-expander"></div>
              </div>

              <!-- <div class="paperdoll-controls-right">
                <div class="paperdoll-fullscreen">
                  <a _ngcontent-xpp-c94="" class="info fullscreen-icon">
                    <i class="fa fa-expand"></i>
                    <span _ngcontent-xpp-c94="" class="info-text"
                      style="color: #fff; margin-top: -47px; margin-left: -30px;">Double-click model to view fullscreen</span>
                  </a>
                </div>
              </div> -->

              <div class="warning-toast-message">
                <span class="warning-toast-message-icon">⚠️</span>
                <br>
                <div class="warning-toast-message-text"></div>
              </div>

              <!-- <div class="paperdoll-controls-left">
                <div class="paperdoll-mount" style="display: block;">
                  <a href="javascript:">Choose Mount</a>
                </div>
              </div> -->

            </div>

            <div class="dressing-room-character-controls-category-switchers">
              <a data-category="gear" id="gear_button" href="javascript:" data-active="true" class=""></a>
              <a data-category="character" id="character_button" href="javascript:" class=""></a>
              <a data-category="face" id="face_button" href="javascript:"></a>
              <a data-category="patch" id="change_game_patch" href="javascript:" style="background-image: url(/static/main_app/images/wrath.png)"></a>
            </div>

            <div class="dressing-room-character-controls-category" id="dressing-room-face-settings" data-category="face">
              <h2 class="heading-size-2">Face</h2>
            </div>

            <div class="dressing-room-character-controls-category" id="dressing-room-character-settings" data-category="character">
              <h2 class="heading-size-2">Character</h2>
              <div class="dressing-room-character-controls-category-option" data-character-customization-type="___race">
                <div data-role="label">Race</div>
                <div tabindex="0" data-role="control" id="select_race_btn">
                  <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                  <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                  <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                </div>
              </div>
              <div class="dressing-room-character-controls-category-option" data-character-customization-type="gender">
                <div data-role="label">Gender</div>
                <div tabindex="0" data-role="control" id="select_gender_btn">
                  <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                  <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                  <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                </div>
              </div>
              <div class="dressing-room-character-controls-category-option" data-character-customization-type="sheathed">
                <div data-role="label">Weapons</div>
                <div tabindex="0" data-role="control" id="select_sheathed_btn">
                  <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                  <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                  <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                </div>
              </div>
              <div class="dressing-room-character-controls-category-option" data-character-customization-type="animation">
                <div data-role="label">Animation</div>
                <div tabindex="0" data-role="control" data-disabled="false" id="select_animation_btn">
                  <a class="btn dress-btn fa fa-caret-left" href="javascript:" tabindex="-1"></a>
                  <a class="imitation-select" data-field-filled="true" href="javascript:" tabindex="-1"></a>
                  <a class="btn dress-btn fa fa-caret-right" href="javascript:" tabindex="-1"></a>
                </div>
              </div>
              <div class="dressing-room-character-controls-category-option" data-character-customization-type="only-item">
                <div data-role="label">
                  <label for="only-item">Только итем</label>
                </div>
                <div data-role="control">
                  <input type="checkbox" name="only-item" id="only-item" data-field-filled="true">
                </div>
              </div>
            </div>

            <div class="dressing-room-character-controls-general">
              <button class="btn dress-btn btn-site fa fa-times" id="dr-reset" type="button">Reset</button>
              <button class="btn dress-btn btn-site fa fa-eye-slash" id="dr-toggle-ui" type="button">Hide UI</button>

              <a _ngcontent-xpp-c94="" class="info">
                <button class="btn dress-btn btn-site fa fa-link" id="dr-links" type="button"
                  onclick="copy_text.copy(document.location.href);">Links</button>
                <span _ngcontent-xpp-c94="" class="info-text"
                  style="color: #fff; margin-top: -95px; margin-left: -75px;">{% trans 'Скопировать ссылку' %}</span>
              </a>

              <button class="btn dress-btn btn-site fa fa-camera" id="dr-screenshot" type="button">Screenshot</button>
              <button class="btn dress-btn btn-site fa fa-pause" id="dr-pause" type="button">Pause</button>
              <div>
                <button class="btn dress-btn btn-site fa fa-random" id="dr-randomize" type="button">Random</button>
                <!-- <button class="btn dress-btn btn-site fa fa-undo" id="dr-undo" type="button">Undo</button>
                <button class="btn dress-btn btn-site fa fa-repeat" id="dr-redo" type="button" disabled="">Redo</button> -->
              </div>
            </div>

          </div>
        </div>

        <script>
          $('#change_game_patch').on('click', function(event) {
            if (!gamePatch || gamePatch == 'wrath') { gamePatch = 'live'; }
            else if (gamePatch == 'live') { gamePatch = 'wrath'; };
            event.target.style.backgroundImage =
            `url(/static/main_app/images/${gamePatch}.png)`;
            localStorage.setItem('game_patch', JSON.stringify(gamePatch));
            warnMessageHandler(6000, `Для изменения на ${gamePatch} патч, пожалуйста, перезагрузите страницу.`);
            // location.reload();
            // location.reload(true);
          });
        </script>

        <script>
          const modelIsLoaded = function(func) {
            return function(...args) {
              // проверяет, была ли создана модель.
              if (!window.model) {
                warnMessageHandler(4000, 'Ошибка, модель не была создана.');
                return false;
              // проверяет, полностью ли загружена модель.
              } else if (!window.model.renderer || !window.model.renderer.models[0].modelIsLoaded) {
              // } else if (!window.model.renderer.viewer.method("isLoaded")) {
                warnMessageHandler(2000, 'Пожалуйста, дождитесь полной загрузки модели.');
                return false;
              } else if (!window.itemsData) {
                warnMessageHandler(2000, 'Пожалуйста, дождитесь полной загрузки базы данных.');
                return false;
              };
              func.apply(this, args);
            };
          };
        </script>

        <script>
          const warning_toast_message = $('.warning-toast-message');

          function warnMessageHandler(duration, message) {
            warning_toast_message.stop(true, true);

            warning_toast_message.find('div').text(message);
            warning_toast_message.css('display', 'block');

            warning_toast_message.animate(
              { opacity: 0 },
              { duration: duration, queue: false,
                complete: function() {
                  warning_toast_message.css('opacity', '1');
                  warning_toast_message.css('display', 'none');
                }
              }
            );
          };
        </script>

        <script>
          function sortItems(items_menu, slot_data, arr=null) {

            const sort_func = (a, b) => {
              if (a.getAttribute('ilvl') == b.getAttribute('ilvl')) {
                return -1;
              };
            };

            if (!arr) {
              const slotItems = items_menu.children[1].getElementsByTagName("A");
              arr = Array.from(slotItems);
            };
            const sortedSlotItemsArray = arr.sort(sort_func);

            // sortedSlotItemsArray.forEach(element => {
            $(sortedSlotItemsArray).each(function(index, element) {

              if (element.getAttribute('type') == slot_data.type
              && element.getAttribute('quality') == slot_data.quality) {
                element.style.display = 'block';
              } else {
                element.style.display = 'none';
              };

              items_menu.children[1].appendChild(element);
            });
            // items_menu.children[1].append(...arr);
          };


          function updateItemsMenuHandler(direction, slot_data, imit_select) {
            direction ? slot_data.index -= 1 : slot_data.index += 1;
            slot_data.type = slot_data.available_types[slot_data.index];
            imit_select.textContent = slot_data.type;
          };


          function clearItemSlotIcon(slotId) {
            let slot_btn = getSlotBtnBySlotId(slotId);
            let ins = slot_btn.children[0];
            const icon = DEFAULT_SLOT_ICONS[slotId];

            ins.style.backgroundImage = `url(${DEFAULT_ICON_URL}${icon}.jpg)`;
            slot_btn.children[2].href = 'javascript:';

            removeItemUnderline(slot_btn.parentElement.children[1].children[1].children[0]);
          };


          function setItemSlotIcon(element, slot_btn) {
            let ins = slot_btn.children[0];
            const icon = element.children[0].children[0].style.backgroundImage.split('/').pop().split('.')[0];
            const itemId = element.href.split('=').pop();

            ins.style.backgroundImage = `url(${DEFAULT_ICON_URL}${icon}.jpg)`;
            slot_btn.children[2].href = `${WH_TOOLTIP_URL}${itemId}`;
          };


          function clearItemSlots(slotId) {

            if (window.dressUI.char.only_item) {
              warnMessageHandler(2000, 'Отключено в режиме "Только итем".');
              return false;
            };

            // console.log('clearItemSlots_before_clearSlots -> model_opts.items:', ...model_opts.items);
            // console.log('clearItemSlots_before_clearSlots -> viewer.options.items:', ...window.model.renderer.viewer.options.items);

            const index = slotIdsIsExists(slotId);
            // если текущий slotId не записан в items тогда выходим из функции
            if (index === false) {
              warnMessageHandler(1500, 'Выбранный слот уже пуст.');
              return false;
            };
            // иначе удаляем итем из items
            model_opts.items.splice(index, 1);

            clearItemSlotIcon(slotId);

            // Удалить итем с указанного айди слота
            window.model.renderer.viewer.method("clearSlots", slotId.toString());
            // удалить несколько итемов по айди слотов (чистит но выдаёт ошибку, хз чё ему не нравится)
            // передаётся строка в таком формате: "21,22"
            // window.model.renderer.viewer.method("clearSlots", [21, 22].join());

            if (slotId == 21 || slotId == 22 || slotId == 23) updateSheathInfo();

            // console.log('clearItemSlots_after_clearSlots -> model_opts.items:', ...model_opts.items);
            // console.log('clearItemSlots_after_clearSlots -> viewer.options.items:', ...window.model.renderer.viewer.options.items);
          };


          function setItemSlots(element_a) {
            const slot_btn = element_a.parentElement.parentElement.parentElement.children[0];
            let slotId = parseInt(slot_btn.getAttribute('data-character-slot'));
            const displayId = parseInt(element_a.getAttribute('display-id'));
            const itemId = parseInt(element_a.href.split('=').pop());

            // Временная заглушка
            if (window.dressUI.char.only_item && slotId != 21 && slotId != 22 && slotId != 23) {
              warnMessageHandler(3000, 'IN DEVELOPMENT\nДоступны только слоты с оружием.');
              return false;
            };

            // console.log('setItemSlots_before_setItems -> model_opts.items:', ...model_opts.items);
            // console.log('setItemSlots_before_setItems -> viewer.options.items:', ...window.model.renderer.viewer.options.items);

            if (!window.dressUI.char.only_item) {

              const index = slotIdsIsExists(slotId);
              // если текущий slotId уже записан в items тогда
              if (index !== false) {
                // если текущий displayId равен записаному в items тогда выходим из функции
                if (model_opts.items[index][1] == displayId) {
                  // warnMessageHandler(1500, 'Надетый и выбранный итемы имеют одинаковые модели.');
                  return false;
                };
                // иначе обновляем displayId на новый
                model_opts.items[index][1] = displayId;
                model_opts.items[index][2] = itemId; // так же обновляем itemId
              // иначе добавляем новый итем в items
              } else {
                model_opts.items.push([slotId, displayId, itemId]);
              };

              switch (slotId) {
                case 22: if (slotIdsIsExists(23) !== false) clearItemSlots(23); break;
                case 23: if (slotIdsIsExists(22) !== false) clearItemSlots(22); break;
              };

            } else {
              if (window.dressUI.char.only_item_data.id === displayId) {
                // warnMessageHandler(1500, 'Надетый и выбранный итемы имеют одинаковые модели.');
                return false;
              };
              window.dressUI.char.only_item_data = {type: 1, id: displayId, itemId: itemId, slotId: slotId};
            };

            removeItemUnderline(element_a);
            element_a.classList.add('text-uline');

            setItemSlotIcon(element_a, slot_btn);

            if (window.dressUI.char.only_item) {
              switch (slotId) {
                case 21: clearItemSlotIcon(22); clearItemSlotIcon(23); break;
                case 22: clearItemSlotIcon(21); clearItemSlotIcon(23); break;
                case 23: clearItemSlotIcon(21); clearItemSlotIcon(22); break;
              };
              window.createItemModel({type: 1, id: displayId});

            } else {
              if (!PREV_ITEM_ELEMS[slotId].current) {
                PREV_ITEM_ELEMS[slotId].current = element_a;
              } else {
                PREV_ITEM_ELEMS[slotId].previous = PREV_ITEM_ELEMS[slotId].current;
                PREV_ITEM_ELEMS[slotId].current = element_a;
              };

              window.model.renderer.viewer.method("clearSlots", slotId.toString());

              // Установить итемы на модель
              window.model.renderer.viewer.method("setItems", [[
                // slotId, displayId, enchantVisualId
                { slot: slotId, display: displayId, visual: 0 },
                // можно устанавливать несколько итемов за раз
                // { slot: 3, display: 65286, visual: 0 },
              ]]);

              if (slotId == 21 || slotId == 22 || slotId == 23) updateSheathInfo();

              // console.log('setItemSlots_after_setItems -> model_opts.items:', ...model_opts.items);
              // console.log('setItemSlots_after_setItems -> viewer.options.items:', ...window.model.renderer.viewer.options.items);
            };
          };


          function getSlotBtnBySlotId(slotId) {
            let toReturn;
            $('.iconlarge').each(function(index, slot_btn) {
              if (slotId == slot_btn.getAttribute('data-character-slot')) {
                toReturn = slot_btn;
                return false;
              };
            });
            return toReturn;
          };


          function slot_switcher(slotId, items_menu) {
            window.dressUI.gear[`slot${slotId}`] = !window.dressUI.gear[`slot${slotId}`];
            window.dressUI.gear[`slot${slotId}`] ? $(items_menu).css('display', 'block') : $(items_menu).css('display', 'none');
          };


          function removeItemUnderline(target) {
            for (let element of target.parentElement.getElementsByTagName("A")) {
              if (element.classList.contains('text-uline')) {
                element.classList.remove('text-uline');
              };
            };
          };


          function itemQualityCheckMarkUpdate(target) {
            for (let element of target.parentElement.getElementsByTagName("A")) {
              if (element.classList.contains('fa-check-square')) {
                element.classList.remove('fa-check-square');
                element.classList.add('fa-square');
              };
            };
            target.classList.add('fa-check-square');
          };


          function generateItemsMenuHtml(slotId) {
            let elements_list = [];

            for (const itemData of window.itemsData[0][slotId]) {

              const element_ins_icon = document.createElement('ins');
              element_ins_icon.style.backgroundImage = `url(${DEFAULT_ICON_URL}${itemData.icon}.jpg)`;

              const element_del_icon = document.createElement('del');

              const element_span_icon = document.createElement('span');
              element_span_icon.classList.add('iconsmall'); // iconsmall // iconmedium // iconlarge
              element_span_icon.appendChild(element_ins_icon);
              element_span_icon.appendChild(element_del_icon);

              const element_span_text = document.createElement('span');
              element_span_text.textContent = itemData.name;

              const element_a = document.createElement('a');
              element_a.classList.add(ITEM_QUALITIES[itemData.quality]);
              element_a.setAttribute('href', `${WH_TOOLTIP_URL}${itemData.itemId}`);
              element_a.setAttribute('display-id', itemData.displayId);
              element_a.setAttribute('quality', itemData.quality);
              element_a.setAttribute('type', itemData.type);
              element_a.setAttribute('ilvl', itemData.ilvl);
              element_a.appendChild(element_span_icon);
              element_a.appendChild(element_span_text);

              elements_list.push(element_a);
            };
            return elements_list
          };


          function generateItemsMenu(slotId, items_menu) {

            const slot_data = window.dressUI.gear.items_menu[`slot${slotId}`];
            const item_types_len = slot_data.available_types.length - 1;
            const elements_list = generateItemsMenuHtml(slotId);

            setAlphaForExtremeButtonPosition(
              items_menu.getElementsByClassName("fa-caret-left")[0],
              0,
              item_types_len
            );

            items_menu.children[0].addEventListener('click', modelIsLoaded(function(event) {

              if (event.target.classList.contains('fa-caret-left') && slot_data.index > 0) {

                updateItemsMenuHandler(true, slot_data, event.target.parentElement.children[1]);
                sortItems(items_menu, slot_data);
                setAlphaForExtremeButtonPosition(event.target, slot_data.index, item_types_len);

              } else if (event.target.classList.contains('fa-caret-right') && slot_data.index < item_types_len) {

                updateItemsMenuHandler(false, slot_data, event.target.parentElement.children[1]);
                sortItems(items_menu, slot_data);
                setAlphaForExtremeButtonPosition(event.target, slot_data.index, item_types_len);
              };

              const quality = event.target.getAttribute('data-quality');
              if (quality && slot_data.quality != quality) {

                itemQualityCheckMarkUpdate(event.target);
                slot_data.quality = quality;
                sortItems(items_menu, slot_data);
              };
            }));

            items_menu.children[1].addEventListener('click', modelIsLoaded(function(event) {
              event.preventDefault(); // блокирует переход по ссылке но обрабатывает клик и отображает тултип
              if (event.target.tagName === 'SPAN') { setItemSlots(event.target.parentElement); }
              else if (event.target.tagName === 'A') { setItemSlots(event.target); };
            }));

            $(items_menu.children[0].children[0]).find('div')[0].children[1].textContent = slot_data.type;
            sortItems(items_menu, slot_data, elements_list);
          };


          function creatingItemsMenu() {
            $('.items-menu').each(function(index, items_menu) {
              const slotId = items_menu.parentElement.children[0].getAttribute('data-character-slot');
              if (slotId != 2 && slotId != 11 && slotId != 12 && slotId != 13 && slotId != 14) {
                generateItemsMenu(slotId, items_menu);
              };
            });
          };


          function slots_handler(event) {
            if (!event.target.parentElement.hasAttribute('data-character-slot')) return false;

            event.preventDefault(); // блокирует переход по ссылке но обрабатывает клик и отображает тултип

            const slotId = event.target.parentElement.getAttribute('data-character-slot');
            const items_menu = event.target.parentElement.parentElement.children[1];

            slot_switcher(slotId, items_menu);
          };


          $('.paperdoll-left a').on('click touchstart', modelIsLoaded(function(event) {
            slots_handler(event);
          }));


          $('.paperdoll-right a').on('click touchstart', modelIsLoaded(function(event) {
            slots_handler(event);
          }));


          $('.paperdoll-bottom a').on('click touchstart', modelIsLoaded(function(event) {
            slots_handler(event);
          }));
        </script>

        <script>
          function setDefaultText() {
            $('#select_race_btn').find('a')[1].textContent = RACES[window.dressUI.char.race_id];
            $('#select_gender_btn').find('a')[1].textContent = GENDERS[window.dressUI.char.gender_id];
            updateSheathText();
            $('#select_animation_btn').find('a')[1].textContent =
            window.dressUI.char.anims_list[window.dressUI.char.anim];

            // updateFaceFields(false);
          };
        </script>

        <script>
          // Character HANDLERS

          $('#select_race_btn a').on('click', modelIsLoaded(function(event) {

            if (this.classList.contains('fa-caret-left') && window.dressUI.char.race_id > 1) {

              RACES[window.dressUI.char.race_id] === 'Bloodelf'
              ? window.dressUI.char.race_id -= 2 : window.dressUI.char.race_id -= 1;

            } else if (this.classList.contains('fa-caret-right') && window.dressUI.char.race_id < 11) {

              RACES[window.dressUI.char.race_id] === 'Troll'
              ? window.dressUI.char.race_id += 2 : window.dressUI.char.race_id += 1;
            };
            model_opts.race = window.dressUI.char.race_id;
            setAlphaForExtremeButtonPosition(event.target, window.dressUI.char.race_id, 11, 1);
            event.target.parentElement.children[1].textContent = RACES[window.dressUI.char.race_id];
            window.createCharModel();
          }));


          $('#select_gender_btn a').on('click', modelIsLoaded(function(event) {

            if (this.classList.contains('fa-caret-left') && window.dressUI.char.gender_id === 1) {

              window.dressUI.char.gender_id -= 1;

            } else if (this.classList.contains('fa-caret-right') && window.dressUI.char.gender_id === 0) {

              window.dressUI.char.gender_id += 1;
            };
            model_opts.gender = window.dressUI.char.gender_id;
            setAlphaForExtremeButtonPosition(event.target, window.dressUI.char.gender_id, 1);
            event.target.parentElement.children[1].textContent = GENDERS[window.dressUI.char.gender_id];
            window.createCharModel();
          }));


          $('#select_sheathed_btn a').on('click', modelIsLoaded(function(event) {

            const sheath_opts_len = window.dressUI.char.sheath_opts.length - 1;

            if (this.classList.contains('fa-caret-left')
            && window.dressUI.char.sheath > 0) {

              window.dressUI.char.sheath -= 1;

            } else if (this.classList.contains('fa-caret-right')
            && window.dressUI.char.sheath < sheath_opts_len) {

              window.dressUI.char.sheath += 1;
            };
            window.model.renderer.viewer.method("setSheath",
            window.dressUI.char.sheath_opts[window.dressUI.char.sheath]);
            updateSheathText();
            setAlphaForExtremeButtonPosition(event.target, window.dressUI.char.sheath, sheath_opts_len);
          }));


          function updateSheathText() {
            if (window.dressUI.char.sheath == 0) {
              $('#select_sheathed_btn').find('a')[1].textContent = 'Unsheathed';
            } else {
              $('#select_sheathed_btn').find('a')[1].textContent = `Sheathed-${window.dressUI.char.sheath}`;
            };
            model_opts.sheathMain = window.dressUI.char.sheath_opts[window.dressUI.char.sheath][0];
            model_opts.sheathOff = window.dressUI.char.sheath_opts[window.dressUI.char.sheath][1];
          };


          $('#select_animation_btn a').on('click', modelIsLoaded(function(event) {

            const anims_list_len = window.dressUI.char.anims_list.length - 1;

            if (this.classList.contains('fa-caret-left')
            && window.dressUI.char.anim > 0) {

              window.dressUI.char.anim -= 1;

            } else if (this.classList.contains('fa-caret-right')
            && window.dressUI.char.anim < anims_list_len) {

              window.dressUI.char.anim += 1;
            };
            setAnim();
            setAlphaForExtremeButtonPosition(event.target, window.dressUI.char.anim, anims_list_len);
          }));


          function setAnim() {
            const anim_name = window.dressUI.char.anims_list[window.dressUI.char.anim];

            window.model.renderer.viewer.method("setAnimation", anim_name);
            // window.model.renderer.viewer.method("resetAnimation"); // Отменить анимацию
            $('#select_animation_btn').find('a')[1].textContent = anim_name;
          };
        </script>

        <script>
          function setAlphaForExtremeButtonPosition(element_a, cur, max, min=0) {

            let caret_left = element_a.parentElement.children[0].classList;
            let caret_right = element_a.parentElement.children[2].classList;

            if (min == max) {
              if (!caret_left.contains('caret-disabled')) caret_left.add('caret-disabled');
              if (!caret_right.contains('caret-disabled')) caret_right.add('caret-disabled');
              return false;
            };

            if (cur == min) {
              if (!caret_left.contains('caret-disabled')) caret_left.add('caret-disabled');
              if (caret_right.contains('caret-disabled')) caret_right.remove('caret-disabled');

            } else if (cur == max) {
              if (!caret_right.contains('caret-disabled')) caret_right.add('caret-disabled');
              if (caret_left.contains('caret-disabled')) caret_left.remove('caret-disabled');

            } else {
              if (caret_left.contains('caret-disabled')) caret_left.remove('caret-disabled');
              if (caret_right.contains('caret-disabled')) caret_right.remove('caret-disabled');
            };
          };


          function refreshAlphaForExtremeButtonPosition(data) {

            const carets = document.querySelector(data.id).getElementsByClassName("fa-caret-left");

            for (let i=0; i < carets.length; i++) {

              const current = data.key === "char"
              ? window.dressUI[data.key][data.fields[i]]
              : window.dressUI[data.key].current[i];

              setAlphaForExtremeButtonPosition(
                carets[i],
                current,
                data.max_len[i],
                data.min_len[i]
              );
            };
          };


          function findElementByItemId(itemId, slot_btn) {
            let slotItems = slot_btn.parentElement.getElementsByClassName('table-responsive')[0].getElementsByTagName("A");
            for (let i=0; i < slotItems.length; i++) {
              if (slotItems[i].href.split('=').pop() == itemId) { return slotItems[i]; };
            };
          };


          function updateItemSlotIcon(flag) {
            // Специальный костыль чтобы убрать подчеркивания и иконки выбранных итемов в режиме "Только итемы"
            if (!flag) {
              for (const slotId of [21, 22, 23]) {
                const slot_btn = getSlotBtnBySlotId(slotId);
                const first_element_a = slot_btn.parentElement.getElementsByClassName('table-responsive')[0].children[0];
                clearItemSlotIcon(slotId);
                removeItemUnderline(first_element_a);
              };
            };

            for (const itemData of model_opts.items) {
              if (flag) {
                clearItemSlotIcon(itemData[0]); // очищаем иконки слот буттонов от итемов при переключении на режим "Только итемы"
              } else {
                const slot_btn = getSlotBtnBySlotId(itemData[0]);
                let element_a = findElementByItemId(itemData[2], slot_btn);

                removeItemUnderline(element_a);
                element_a.classList.add('text-uline');

                setItemSlotIcon(element_a, slot_btn);
              };
            };

            if (flag) {
              const slot_btn = getSlotBtnBySlotId(window.dressUI.char.only_item_data.slotId);
              let element_a = findElementByItemId(window.dressUI.char.only_item_data.itemId, slot_btn);
              element_a.classList.add('text-uline');
              setItemSlotIcon(element_a, slot_btn);
            };
          };


          function set_race_gender_image() {
            const race = RACES[window.dressUI.char.race_id].toLowerCase();
            const gender = GENDERS[window.dressUI.char.gender_id].toLowerCase();
            $('#character_button').css('background-image',
            `url(${DEFAULT_ICON_URL}race_${race}_${gender}.jpg)`);
          };


          function set_gear_image() {
            const cloth_gear = 'inv_chest_cloth_21';
            const leather_gear = 'inv_chest_leather_09';
            const chain_gear = 'inv_chest_chain_05';
            const plate_gear = 'inv_chest_plate15';
            $('#gear_button').css('background-image',
            `url(${DEFAULT_ICON_URL}${plate_gear}.jpg)`);
          };
          // set_gear_image();
        </script>

        <script>
          const gear_button = $('#gear_button')[0];
          const face_button = $('#face_button')[0];
          const char_button = $('#character_button')[0];
          const patch_button = $('#change_game_patch')[0];

          const paperdoll_left = $('.paperdoll-left')[0];
          const paperdoll_right = $('.paperdoll-right')[0];
          const paperdoll_bottom = $('.paperdoll-bottom')[0];

          const face_settings = $('#dressing-room-face-settings')[0];
          const char_settings = $('#dressing-room-character-settings')[0];

          const fullscreen_hint = $('.paperdoll-controls-right')[0];

          $('.dressing-room-character-controls-category-switchers a').on('click', function(event) {

            const category = event.target.getAttribute('data-category');
            event.target.setAttribute('data-active', 'true');

            if (category === 'gear') {
              removeAttr('data-active', face_button, char_button);
              setDisplayState('block', paperdoll_left, paperdoll_right, paperdoll_bottom);
              setDisplayState('none', face_settings, char_settings);
              window.dressUI.active_cat = 'gear';

              if (!window.dressUI.char.only_item) { window.model.renderer.viewer.setZoom(-2); window.model.renderer.viewer.setOffset(0, 0); };

            } else if (category === 'face') {
              removeAttr('data-active', gear_button, char_button);
              setDisplayState('block', face_settings);
              setDisplayState('none', paperdoll_left, paperdoll_right, paperdoll_bottom, char_settings);
              window.dressUI.active_cat = 'face';

              if (!window.dressUI.char.only_item) setFaceZoom();

            } else if (category === 'character') {
              removeAttr('data-active', gear_button, face_button);
              setDisplayState('block', char_settings);
              setDisplayState('none', paperdoll_left, paperdoll_right, paperdoll_bottom, face_settings);
              window.dressUI.active_cat = 'character';

              if (!window.dressUI.char.only_item) { window.model.renderer.viewer.setZoom(-2); window.model.renderer.viewer.setOffset(0, 0); };
            };
          });


          function setFaceZoom() {
            let zoom, offSetY;
            switch (model_opts.race) { //            Female                         Male
              case 1:  model_opts.gender ? (zoom = 12.6, offSetY = 0.75) : (zoom = 12.6, offSetY = 0.80); break; // Human
              case 2:  model_opts.gender ? (zoom = 12.6, offSetY = 0.75) : (zoom = 8, offSetY = 0.80); break; // Orc
              case 3:  model_opts.gender ? (zoom = 9, offSetY = 0.55) : (zoom = 9, offSetY = 0.55); break; // Dwarf
              case 4:  model_opts.gender ? (zoom = 12.6, offSetY = 0.95) : (zoom = 12.6, offSetY = 1.00); break; // Nightelf
              case 5:  model_opts.gender ? (zoom = 12.6, offSetY = 0.75) : (zoom = 12.6, offSetY = 0.80); break; // Scourge
              case 6:  model_opts.gender ? (zoom = 9, offSetY = 0.80) : (zoom = 6, offSetY = 0.65); break; // Tauren
              case 7:  model_opts.gender ? (zoom = 8, offSetY = 0.25) : (zoom = 7, offSetY = 0.35); break; // Gnome
              case 8:  model_opts.gender ? (zoom = 12.6, offSetY = 0.90) : (zoom = 11, offSetY = 0.80); break; // Troll
              case 10: model_opts.gender ? (zoom = 12.6, offSetY = 0.75) : (zoom = 12.6, offSetY = 0.80); break; // Bloodelf
              case 11: model_opts.gender ? (zoom = 12.6, offSetY = 0.95) : (zoom = 10, offSetY = 0.95); break; // Draenei
            };
            window.model.renderer.viewer.setZoom(zoom);
            window.model.renderer.viewer.setOffset(0, offSetY);
          };


          $('#dr-toggle-ui').on('click', function(event) {
            window.dressUI.show = !window.dressUI.show;

            if (window.dressUI.show) {
              setDisplayState('none', gear_button, face_button, char_button, patch_button, paperdoll_left,
              paperdoll_right, paperdoll_bottom, face_settings, char_settings, fullscreen_hint);
            } else {
              setDisplayState('block', gear_button, face_button, char_button, patch_button, fullscreen_hint);

              if (window.dressUI.active_cat === 'gear') {
                setDisplayState('block', paperdoll_left, paperdoll_right, paperdoll_bottom);
              } else if (window.dressUI.active_cat === 'face') {
                setDisplayState('block', face_settings);
              } else if (window.dressUI.active_cat === 'character') {
                setDisplayState('block', char_settings);
              };
            };
          });


          function removeAttr(attr, ...elements) { for (let element of elements) element.removeAttribute(attr); };

          function setDisplayState(state, ...elements) { for (let element of elements) element.style.display = state; };


          const copy_text = new CopyText();
        </script>

        <script type="module">
          import {
            findRaceGenderOptions,
            generateModels,
            optionsFromModel
          } from "{% static 'main_app/javascript/wow-model-viewer/model_viewer_utils.js' %}";


          window.generateFaceOptionHtml = function(i, optionName) {
            const caret_left = document.createElement('a');
            caret_left.classList.add('btn');
            caret_left.classList.add('dress-btn');
            caret_left.classList.add('fa');
            caret_left.classList.add('fa-caret-left');
            caret_left.setAttribute('href', 'javascript:');
            caret_left.setAttribute('tabindex', '-1');

            const imit_sel = document.createElement('a');
            imit_sel.classList.add('imitation-select');
            imit_sel.setAttribute('data-field-filled', 'true');
            imit_sel.setAttribute('href', 'javascript:');
            imit_sel.setAttribute('tabindex', '-1');
            window.dressUI.face.have_text_opt[i] // если опция без названий будем использовать просто индексы
            ? imit_sel.textContent = window.dressUI.face.have_text_opt[i]
            : imit_sel.textContent = window.dressUI.face.current[i] + 1;

            const caret_right = document.createElement('a');
            caret_right.classList.add('btn');
            caret_right.classList.add('dress-btn');
            caret_right.classList.add('fa');
            caret_right.classList.add('fa-caret-right');
            caret_right.setAttribute('href', 'javascript:');
            caret_right.setAttribute('tabindex', '-1');

            const caret_div = document.createElement('div');
            caret_div.setAttribute('tabindex', '0');
            caret_div.setAttribute('data-role', 'control');
            caret_div.appendChild(caret_left);
            caret_div.appendChild(imit_sel);
            caret_div.appendChild(caret_right);

            const label = document.createElement('div');
            label.setAttribute('data-role', 'label');
            label.textContent = optionName;

            const cat_opt_div = document.createElement('div');
            cat_opt_div.classList.add('dressing-room-character-controls-category-option');
            cat_opt_div.setAttribute('data-character-customization-type', window.dressUI.face.fields[i]);
            cat_opt_div.appendChild(label);
            cat_opt_div.appendChild(caret_div);

            face_settings.appendChild(cat_opt_div);

            return cat_opt_div;
          };


          window.generateFaceOptions = function() {
            // очистка настроек при создании новой модели
            window.dressUI.face.fields = [];
            window.dressUI.face.have_text_opt = [];
            window.dressUI.face.max_len = [];
            window.dressUI.face.min_len = [];
            window.dressUI.face.current = [];

            const default_index = 0;
            const NOT_ALLOWED_CHAR_OPTS = [
              // 'Hair Color', 'Piercings'
            ];
            const race_gender_opts = window.dressUI.face.race_gender_opts;

            for (const i in race_gender_opts) {
              const option = race_gender_opts[i];

              if (NOT_ALLOWED_CHAR_OPTS.indexOf(option.Name) !== -1) continue;

              const opt_name = option.Name.replace(' ', '_').toLowerCase();
              const choice_name = option.Choices[default_index].Name;
              const max_len = option.Choices.length - 1;

              window.dressUI.face.fields.push(opt_name);
              window.dressUI.face.have_text_opt.push(choice_name);
              window.dressUI.face.max_len.push(max_len);
              window.dressUI.face.min_len.push(0);
              window.dressUI.face.current.push(default_index);

              model_opts[opt_name] = default_index;

              const cat_opt_div = window.generateFaceOptionHtml(i, option.Name);


              cat_opt_div.addEventListener('click', modelIsLoaded(function(event) {

                if (event.target.classList.contains('fa-caret-left') && window.dressUI.face.current[i] > 0) {
                  window.dressUI.face.current[i] -= 1;
                } else if (event.target.classList.contains('fa-caret-right') && window.dressUI.face.current[i] < max_len) {
                  window.dressUI.face.current[i] += 1;
                };
                setAlphaForExtremeButtonPosition(event.target, window.dressUI.face.current[i], max_len);

                event.target.parentElement.children[1].textContent = choice_name
                ? race_gender_opts[i].Choices[window.dressUI.face.current[i]].Name
                : window.dressUI.face.current[i] + 1;

                model_opts[opt_name] = window.dressUI.face.current[i];
                window.model.updateAppearance(model_opts);
              }));
            };
          };


          window.generateCharModel = async function() {

            // глубокая копия model_opts для удаления itemId из items для последующей передачи в generateModels
            let dc_model_opts = JSON.parse(JSON.stringify(model_opts));
            dc_model_opts.items = [...new Set(dc_model_opts.items.map(item => [item[0], item[1]]))];

            window.model = await generateModels(
              '#paperdoll-model-dressing-room-paperdoll',
              Object.assign(dc_model_opts, {
                // generalOptions: {
                //   background: "background-181818.png"
                // }
              })
            );

            window.model.setModelLoadedCallback(function() {
            // window.model.renderer.viewer.method("setModelLoadedCallback", function() {
              $('.paperdoll-model').css('background', 'none');

              window.model.renderer.viewer.method("setSheath",
              window.dressUI.char.sheath_opts[window.dressUI.char.sheath]);

              updateAnimPaused(true);

              const {animNames, standIndex} = window.model.getListAnimations();
              window.dressUI.char.anims_list = animNames;
              window.dressUI.char.default_anim = standIndex;
              window.dressUI.char.anim = standIndex;

              setDefaultText();

              const char_data = {
                id: '#dressing-room-character-settings',
                key: 'char',
                fields: ['race_id', 'gender_id', 'sheath', 'anim'],
                max_len: [11, 1, window.dressUI.char.sheath_opts.length - 1, window.dressUI.char.anims_list.length - 1],
                min_len: [1, 0, 0, 0]
              };
              refreshAlphaForExtremeButtonPosition(char_data);

              window.model.renderer.viewer.setZoom(-2);
            });
            // window.model.renderer.viewer.method("setCustomizationsLoadedCallback", function(t) { console.log('setCustomizationsLoadedCallback', t); });
            // window.model.renderer.screenshotCallback = function() { console.log('screenshotCallback'); };
            window.errorLoadingItemCallback = function(data) {
              warnMessageHandler(2000, 'К сожалению не удалось загрузить итем.');

              if (PREV_ITEM_ELEMS[data.slotId].previous) {
                setItemSlots(PREV_ITEM_ELEMS[data.slotId].previous);
              } else {
                PREV_ITEM_ELEMS[data.slotId].current = null;
                clearItemSlots(data.slotId);
              };
            };

            set_race_gender_image();
          };


          window.createCharModel = function() {
            if (window.model) window.model.renderer.models[0].modelIsLoaded = false;

            $('.paperdoll-model').css('background', 'url(https://wow.zamimg.com/images/icons/ajax.gif) center no-repeat');

            $('#dressing-room-face-settings div').each(function(index, option) {
              if (option.classList.contains('dressing-room-character-controls-category-option')) {
                delete model_opts[option.getAttribute('data-character-customization-type')];
                option.remove();
              };
            });

            // Получить все доступные опции для указанной расы и гендера
            findRaceGenderOptions(model_opts.race, model_opts.gender).then((fullOptions) => {
              window.dressUI.face.race_gender_opts = fullOptions.Options;

              window.generateFaceOptions();

              refreshAlphaForExtremeButtonPosition(window.dressUI.face);

              window.generateCharModel();
            });
          };


          $(document).ready(function() {

            window.createCharModel();

            //////////////// TEST №1 ////////////////
            // model_opts.items = [ // items with CORS policy
            //   [1, 64897],
            //   [3, 64896],
            //   [16, 22996],
            //   [5, 64859],
            //   [4, 11977],
            //   [19, 65733],
            //   [9, 63901],
            //   [21, 65153],
            //   [22, 45146],
            //   [10, 63910],
            //   [6, 109302],
            //   [7, 64246],
            //   [8, 63825]
            // ];
            // window.createCharModel();
            // setInterval(function() { modelIsLoaded(window.createCharModel)(); }, 4);
            //////////////// TEST №1 ////////////////

            //////////////// TEST №2 ////////////////
            // window.dressUI.char.only_item = true;
            // window.createItemModel({type: 1, id: 65153});
            // setInterval(function() { modelIsLoaded(window.createItemModel)({type: 1, id: 65153}); }, 4);
            //////////////// TEST №2 ////////////////
          });


          window.createItemModel = async function(opts) {
            if (window.model) window.model.renderer.models[0].modelIsLoaded = false;

            $('.paperdoll-model').css('background', 'url(https://wow.zamimg.com/images/icons/ajax.gif) center no-repeat');

            window.model = await generateModels(
              '#paperdoll-model-dressing-room-paperdoll',
              Object.assign(opts, {
                // generalOptions: {
                //   background: "background-181818.png"
                // }
              })
            );

            window.model.setModelLoadedCallback(function() {
            // window.model.renderer.viewer.method("setModelLoadedCallback", function() {
              $('.paperdoll-model').css('background', 'none');

              window.dressUI.AnimIsPaused = false;
              updateAnimPaused();

              document.documentElement.clientWidth < 800 ? window.model.renderer.viewer.setZoom(-2) : window.model.renderer.viewer.setZoom(-8);
            });
            window.errorLoadingItemCallback = function(data) {
              warnMessageHandler(2000, 'К сожалению не удалось загрузить итем.');
              if (data.slotId) clearItemSlotIcon(data.slotId);
            };
          };


          $('#only-item').on('click', modelIsLoaded(function(event) {
            window.dressUI.char.only_item = event.target.checked;

            if (window.dressUI.char.only_item) {
              const char_data = {
                id: '#dressing-room-character-settings',
                key: 'char',
                fields: ['race_id', 'gender_id', 'sheath', 'anim'],
                max_len: [1, 0, 0, 0],
                min_len: [1, 0, 0, 0]
              };
              refreshAlphaForExtremeButtonPosition(char_data);

              let dc_face_data = JSON.parse(JSON.stringify(window.dressUI.face));
              dc_face_data.max_len = [];
              for (const _ in dc_face_data.fields) dc_face_data.max_len.push(0);
              refreshAlphaForExtremeButtonPosition(dc_face_data);

              warnMessageHandler(4000, 'Теперь вы можете просматривать итемы без персонажа.');
              updateItemSlotIcon(true);
              window.createItemModel(window.dressUI.char.only_item_data);
            } else {
              warnMessageHandler(4000, 'Теперь вы можете просматривать итемы на персонаже.');
              updateItemSlotIcon(false);
              window.createCharModel();
            };
          }));


          function get_items_data_from_database_file() {
            fetch("{% static 'main_app/json/itemsdata.json' %}")
            .then((response) => response.json())
            // .then((json) => json.map((x) => {
            //   x.icon = `${DEFAULT_ICON_URL}${x.icon}.jpg`;
            //   return x;
            // }))
            .then((data) => {
              window.itemsData = data;
              creatingItemsMenu();
            });
          };
          get_items_data_from_database_file();
        </script>

        <script>
          function updateFaceFields(random_vals=true) {
            const face_data = window.dressUI.face;

            for (const i in face_data.fields) {

              const field_name = face_data.fields[i];
              const max_len = face_data.max_len[i];

              const int_param = random_vals ? get_rand_int(0, max_len) : face_data.current[i];
              model_opts[field_name] = int_param;
              face_data.current[i] = int_param;

              const imit_sel = $(`.dressing-room-character-controls-category-option[data-character-customization-type="${field_name}"]`).find('a')[1];
              imit_sel.textContent = face_data.have_text_opt[i]
              ? window.dressUI.face.race_gender_opts[i].Choices[int_param].Name
              : int_param + 1;

              setAlphaForExtremeButtonPosition(imit_sel, int_param, max_len);
            };
          };


          $('#dr-randomize').on('click', modelIsLoaded(function(event) {
            updateFaceFields();
            window.model.updateAppearance(model_opts);
          }));


          $('#dr-reset').on('click', modelIsLoaded(function(event) {

            if (document.documentElement.clientWidth < 800) {
              window.model.renderer.viewer.setZoom(-2); // range(-14.5, 12.6)
            } else {
              window.dressUI.char.only_item ? window.model.renderer.viewer.setZoom(-8) : window.model.renderer.viewer.setZoom(-2);
            };

            // window.model.renderer.distance = 6;
            window.model.renderer.azimuth = 1.5 * Math.PI; // горизонталь
            window.model.renderer.zenith = Math.PI / 2; // вертикаль
            window.model.renderer.viewer.setOffset(0, 0); // X, Y

            window.dressUI.char.anim = window.dressUI.char.default_anim;

            setAlphaForExtremeButtonPosition(
              $('#select_animation_btn')[0].children[0],
              window.dressUI.char.anim,
              window.dressUI.char.anims_list.length - 1,
              0
            );
            setAnim();
          }));


          $('#dr-screenshot').on('click', modelIsLoaded(function(event) {
            window.model.makeScreenshot();
          }));


          const dr_pause = $('#dr-pause');
          dr_pause.on('click', modelIsLoaded(function(event) {
            window.dressUI.AnimIsPaused = !window.dressUI.AnimIsPaused;
            updateAnimPaused(true);
          }));

          function updateAnimPaused(flag) {
            if (window.dressUI.AnimIsPaused) {
              dr_pause[0].classList.remove('fa-pause');
              dr_pause[0].classList.add('fa-play');
            } else {
              dr_pause[0].classList.remove('fa-play');
              dr_pause[0].classList.add('fa-pause');
            };
            if (flag) setTimeout(() => { window.model.renderer.viewer.method("setAnimPaused", window.dressUI.AnimIsPaused); }, 4);
          };
        </script>

      </div>
    </div>
  </div>
</app-dressing-room>
{% endblock %}
